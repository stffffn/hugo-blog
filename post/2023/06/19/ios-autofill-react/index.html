<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><link rel=alternate type=application/rss+xml title="RSS Feed for blabli.blog" href=https://blabli.blog/index.xml><meta property="og:title" content="How to trigger iOS Login Autofill for a local React Project / Bla Bli Blog"><meta property="og:description" content="
    
      How to trigger the automatic iOS Login Autofill for a locally running React Project.
    
  "><meta property="og:type" content="
    article
  "><meta property="og:url" content="https://blabli.blog/post/2023/06/19/ios-autofill-react/"><meta property="og:image" content="https://blabli.blog/default-feature-image.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-19T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-19T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blabli.blog/default-feature-image.png"><meta name=twitter:title content="How to trigger iOS Login Autofill for a local React Project / Bla Bli Blog"><meta name=twitter:description content="
    
      How to trigger the automatic iOS Login Autofill for a locally running React Project.
    
  "><title>How to trigger iOS Login Autofill for a local React Project / Bla Bli Blog</title><meta name=author content="stffffn"><meta name=description content="
        
          How to trigger the automatic iOS Login Autofill for a locally running React Project.
        

      
      "><link key=canonical rel=canonical href=https://blabli.blog/post/2023/06/19/ios-autofill-react/><link rel=icon type=image/png sizes=32x32 href=https://blabli.blog/favicons/favicon-32.png><link rel=icon type=image/png sizes=128x128 href=https://blabli.blog/favicons/favicon-128.png><link rel=icon type=image/png sizes=192x192 href=https://blabli.blog/favicons/favicon-192.png><link rel=apple-touch-icon type=image/png sizes=152x152 href=https://blabli.blog/favicons/favicon-152.png><link rel=apple-touch-icon type=image/png sizes=167x167 href=https://blabli.blog/favicons/favicon-167.png><link rel=apple-touch-icon type=image/png sizes=180x180 href=https://blabli.blog/favicons/favicon-180.png><link rel="shortcut icon" type=image/png sizes=196x196 href=https://blabli.blog/favicons/favicon-196.png><link rel=stylesheet href=https://blabli.blog/scss/styles.css><link href=https://blabli.blog/fontawesome/css/fontawesome.min.css rel=stylesheet><link href=https://blabli.blog/fontawesome/css/brands.min.css rel=stylesheet><link href=https://blabli.blog/fontawesome/css/solid.min.css rel=stylesheet></head><body><header><a aria-label=Home title="Bla Bli Blog" href=https://blabli.blog>Bla Bli Blog</a><nav><a class=menu-item aria-label=Tags title=Tags href=https://blabli.blog/tags/><i class="fa-solid fa-hashtag"></i></a>
<a class=menu-item aria-label=RSS title=RSS href=https://blabli.blog/index.xml><i class="fa-solid fa-square-rss"></i></a>
<a class=menu-item target=_blank rel="noopener noreferrer" aria-label=GitHub title=GitHub href=https://github.com/stffffn><i class="fa-brands fa-github"></i></a>
<a class=menu-item target=_blank rel="noopener noreferrerme" aria-label=Mastodon title=Mastodon href=https://mastodon.social/@stffffn><i class="fa-brands fa-mastodon"></i></a></nav></header><main><article><div class=post-info><h2>How to trigger iOS Login Autofill for a local React Project</h2><div class=post-data><time datetime=2023-06-19>June 19, 2023</time><div class=post-tags><a aria-label=#development title=#development href=https://blabli.blog/tags/development>#development</a>
<a aria-label=#frontend title=#frontend href=https://blabli.blog/tags/frontend>#frontend</a>
<a aria-label=#ios title=#ios href=https://blabli.blog/tags/ios>#ios</a>
<a aria-label=#macos title=#macos href=https://blabli.blog/tags/macos>#macos</a>
<a aria-label=#react title=#react href=https://blabli.blog/tags/react>#react</a></div></div></div><details class=toc><summary>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#tlddr>tld;dr</a></li><li><a href=#intro>Intro</a></li><li><a href=#save-login-data-on-ios>Save login data on iOS</a></li><li><a href=#what-did-not-work>What did not work</a><ul><li><a href=#url-restrictions>URL restrictions</a></li><li><a href=#connections-without-https>Connections without https</a><ul><li><a href=#customizing-the-etchosts-file>Customizing the <code>/etc/hosts</code> file</a></li><li><a href=#starting-the-app-on-port-80-http>Starting the app on port 80 (http)</a></li><li><a href=#hypothesis>Hypothesis</a></li></ul></li></ul></li><li><a href=#what-worked>What worked</a><ul><li><a href=#tunneling-services>Tunneling Services</a><ul><li><a href=#ngrok>ngrok</a></li><li><a href=#localtunnel>Localtunnel</a></li><li><a href=#how-to-tunnel-service>How to Tunnel Service</a></li></ul></li><li><a href=#local-ssl-certificate>Local SSL certificate</a><ul><li><a href=#create-the-certificate>Create the certificate</a></li><li><a href=#install-the-root-certificate-on-ios>Install the root certificate on iOS</a></li><li><a href=#start-the-react-app>Start the React app</a></li></ul></li></ul></li></ul></nav></details><div class=post-content><p>I once had to debug a problem for a React project that was a side effect of the automatic iOS login autofill. Triggering the iOS autofill for a locally running React project wasn&rsquo;t quite straightforward, so I wanted to document my findings in this blog post.</p><h2 id=tlddr><a href=#tlddr>tld;dr</a></h2><p>You need an https connection with a valid SSL certificate or it won&rsquo;t work.</p><p>How to do this is explained below.</p><h2 id=intro><a href=#intro>Intro</a></h2><p>Safari on iOS offers autofill for login forms if you have the login information stored in your keychain.</p><p>However, autofill is only triggered automatically if you have a secure connection (https) with a valid SSL certificate. Otherwise, autofill is offered, but only if you click on the corresponding input field yourself.</p><p>The motto seems to be: We only offer it to you automatically if it is really secure, otherwise you do it consciously on your own responsibility.</p><div class="alert alert-info"><h3>Real Device & Simulator</h3><p>It works both with a real iOS device as well as with the simulator available on macOS.</p></div><h2 id=save-login-data-on-ios><a href=#save-login-data-on-ios>Save login data on iOS</a></h2><p>As already mentioned, the autofill can only be triggered if the login data for the matching URL has been saved. Therefore, I want like to document the creation of this data at the beginning, as we will refer to it in the process.</p><p>The procedure is similar for a real device and the simulator:</p><ol><li>Open the &ldquo;Settings&rdquo; app</li><li>Go to &ldquo;Passwords&rdquo;</li><li>Real: Enter the device password
Simulator: Enter anything</li><li>Enable &ldquo;Autofill Passwords&rdquo;</li><li>Add a new entry with the + symbol</li><li>For &ldquo;Website&rdquo; insert the corresponding URL</li><li>Fill in &ldquo;User Name&rdquo; and &ldquo;Password&rdquo; according to the user data</li></ol><h2 id=what-did-not-work><a href=#what-did-not-work>What did not work</a></h2><p>Since I can well imagine that some people will come up with similar ideas to mine when reading this post, I have also documented all the variants I tried that did not work, for the sake of completeness. So you don&rsquo;t have to do that anymore!</p><p>In the beginning, I tried to see if the autofill would work simply via localhost or the corresponding IP in the network, but that didn&rsquo;t work. I made some assumptions about this below.</p><h3 id=url-restrictions><a href=#url-restrictions>URL restrictions</a></h3><ul><li>A <code>localhost</code> address cannot be saved manually via the settings. It can only be saved via the context menu at a new login.</li><li>However, an IP can be entered manually</li></ul><h3 id=connections-without-https><a href=#connections-without-https>Connections without https</a></h3><h4 id=customizing-the-etchosts-file><a href=#customizing-the-etchosts-file>Customizing the <code>/etc/hosts</code> file</a></h4><ul><li>Assumption: An IP is not accepted for the autofill (although you could create the login data manually).</li><li>E.g. from <code>127.0.0.1 localhost</code> to <code>127.0.0.1 thisisafakedomain.com</code></li><li>Calling the page (<code>thisisafakedomain.com:3000</code>) works fine, but autofill is still not triggered</li></ul><h4 id=starting-the-app-on-port-80-http><a href=#starting-the-app-on-port-80-http>Starting the app on port 80 (http)</a></h4><ul><li>Assumption: A domain with port specification is not accepted for autofill (although you could create the login data manually).</li><li>Background: Port 80 is reserved for http, so you don&rsquo;t need to specify the port anymore. So instead of <code>thisisafakedomain.com:3000</code> you can simply call <code>thisisafakedomain.com</code>.</li><li>It can be started with <code>sudo PORT=80 npm run serve</code>.</li><li>Calling the page works fine, but autofill is still not triggered</li></ul><h4 id=hypothesis><a href=#hypothesis>Hypothesis</a></h4><p>Since neither an IP nor the additional specification of a port in a URL can be responsible for this, only the insecure connection (http instead of https) remains after the exclusion procedure due to the lack of an SSL certificate.</p><h2 id=what-worked><a href=#what-worked>What worked</a></h2><h3 id=tunneling-services><a href=#tunneling-services>Tunneling Services</a></h3><p>To avoid going straight back into some configuration cave, I first tried Tunneling Services to test my hypothesis.</p><h4 id=ngrok><a href=#ngrok>ngrok</a></h4><p>I tested <a target=_blank rel="noopener noreferrer" href=https://ngrok.com/ aria-label=ngrok title=ngrok>ngrok</a> first. It worked right out of the box and the free tier allows non-commercial use. If you want to use it in a commercial project, you have to use one of the paid tiers.</p><h4 id=localtunnel><a href=#localtunnel>Localtunnel</a></h4><p>Now it is clear that a tunneling service works. During a short research I stumbled upon <a target=_blank rel="noopener noreferrer" href=https://theboroer.github.io/localtunnel-www/ aria-label=Localtunnel title=Localtunnel>Localtunnel</a>, which also worked right out of the box.</p><p>Localtunnel can also be installed on macOS via <a target=_blank rel="noopener noreferrer" href=https://formulae.brew.sh/formula/localtunnel#default aria-label="Homebrew localtunnel" title="Homebrew localtunnel">Homebrew</a>.</p><p>Just start the React app and start the tunnel with <code>lt --port 3000</code> (or whatever port your React app is running on). The terminal will provide a URL that allows you to access the local application from anywhere and still make local changes to the code.</p><h4 id=how-to-tunnel-service><a href=#how-to-tunnel-service>How to Tunnel Service</a></h4><ol><li>Start your app</li><li>Launch your tunnel service</li><li>Follow the instructions to create login data and use the corresponding URL provided by your tunnel service</li><li>Open this URL with Safari (make sure that the URL is also opened with https!)</li><li>You should be greeted directly by the native iOS autofill context menu on your login page</li><li>Happy debugging!</li></ol><h3 id=local-ssl-certificate><a href=#local-ssl-certificate>Local SSL certificate</a></h3><p>If you do not want to use a tunneling service, a local SSL certificate is another alternative.</p><div class="alert alert-info"><h3>Follow along</h3><p>If you want to follow the next steps directly, I&rsquo;ve provided a super simple React project on <a target=_blank rel="noopener noreferrer" href=https://github.com/stffffn/ios-autofill-test>GitHub</a> with a dummy login form.</p></div><h4 id=create-the-certificate><a href=#create-the-certificate>Create the certificate</a></h4><p>You can use <a target=_blank rel="noopener noreferrer" href=https://github.com/FiloSottile/mkcert aria-label="GitHub mkcert" title="GitHub mkcert">mkcert</a> to create locally valid certificates. For macOS, it can be installed via <a target=_blank rel="noopener noreferrer" href=https://formulae.brew.sh/formula/mkcert#default aria-label="Homebrew mkcert" title="Homebrew mkcert">Homebrew</a>, for example.</p><p>After the installation we first create a Local Certificate Authority, which creates a root certificate and a key.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkcert -install
</span></span></code></pre></div><p>Next, we need to create the necessary certificates for our React project. The best way to do this is to navigate to the root directory of your React project and create a <code>certificate</code> folder there, for example with:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir certificate
</span></span><span style=display:flex><span>mkcert -key-file ./certificate/key.pem -cert-file ./certificate/cert.pem localhost <span style=color:#c678dd>$(</span>ifconfig | grep <span style=color:#98c379>&#39;inet &#39;</span> | grep -Fv 127.0.0.1 | awk <span style=color:#98c379>&#39;NR==1{print $2}&#39;</span><span style=color:#c678dd>)</span>
</span></span></code></pre></div><p>This command creates the private key and a certificate valid for <code>localhost</code> and the IP of your device on the local network.</p><p>Now we need to add a script to the <code>package.json</code> file to be able to start the app with https and the corresponding certificate as well:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#63c381>&#34;start:https&#34;</span>: <span style=color:#63c381>&#34;HTTPS=true SSL_CRT_FILE=./certificate/cert.pem SSL_KEY_FILE=./certificate/key.pem npm run start&#34;</span>
</span></span></code></pre></div><h4 id=install-the-root-certificate-on-ios><a href=#install-the-root-certificate-on-ios>Install the root certificate on iOS</a></h4><p>Now we just need to tell iOS to trust our Local Certificate Authority.</p><p>In this case, I will limit myself to the macOS simulator. The installation on a real device is identical, only the way how you get the root certificate on your device is a bit different and up to you (Airdrop, Email, NAS, etc.).</p><p>If you don&rsquo;t remember where the root certificate was created, you can find it out with this command:</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkcert -CAROOT
</span></span></code></pre></div><p>Under macOS it is most likely located under <code>/Users/&lt;YourUsername>/Library/Application Support/mkcert</code> and is named <code>rootCA.pem</code>.</p><p>Unfortunately, with the latest restrictions on macOS, it is no longer possible to drag and drop certificates onto the simulator. However, we can still install it relatively easily via the path. If your root certificate is located under the same path, you can copy the following link and paste it into Safari (don&rsquo;t forget to change the username!): <code>file:///Users/&lt;YourUsername>/Library/Application%20Support/mkcert/rootCA.pem</code></p><p>You will see a dialog asking you, if you want to allow the download of a configuration file. Click &ldquo;Allow&rdquo;. After that, You will then see a message indicating that the profile has been downloaded.</p><p>Then open the &ldquo;Settings&rdquo; app, navigate to &ldquo;General&rdquo; and then to &ldquo;Device Management. The certificate will already be listed there. Click on it and install it.</p><p>That&rsquo;s all we needed to do on iOS.</p><h4 id=start-the-react-app><a href=#start-the-react-app>Start the React app</a></h4><p>Now we start the React app with the <code>npm run start:https</code> script we created earlier.</p><p>Then we take our iOS device or the simulator, open the &ldquo;Settings&rdquo; app, navigate to &ldquo;Passwords&rdquo; and add an entry for the corresponding IP. Don&rsquo;t forget to add &ldquo;https://&rdquo; and the port at the end. If you are using my GitHub project as a test, just enter anything for the username and password.</p><p>Now we can open the website directly from the password details page and should be greeted by the automatically triggered iOS autofill. Done!</p><p>Here is a short demo video:</p><video preload=metadata controls>
<source src="https://blabli.blog/images/autofill/autofill.mp4#t=0.001" type=video/mp4>Your browser does not support the video tag.</video></div></article></main><footer><span>&copy;
2022&nbsp;&ndash;
2023
stffffn</span><div><span>Content is
<a target=_blank rel="noopener noreferrer" aria-label="Creative Commens CC BY-SA 4.0" title="Creative Commens CC BY-SA 4.0" href=https://creativecommons.org/licenses/by-sa/4.0/>CC-BY-SA 4.0</a>,</span>
<span><a target=_blank rel="noopener noreferrer" aria-label="Source code" title="Source code" href=https://github.com/stffffn/hugo-blog>Source code</a>
is
<a target=_blank rel="noopener noreferrer" aria-label="GNU General Public License 3.0" title="GNU General Public License 3.0" href=https://www.gnu.org/licenses/gpl-3.0.en.html>GPL 3.0</a></span></div></footer></body></html>